<div class="container">
    <h2 class="text-center">Upload Cadet Data</h2>
    <form id="uploadForm">
        <div class="mb-3">
            <label for="detachmentId" class="form-label">Detachment ID:</label>
            <input type="text" class="form-control" id="detachmentId" placeholder="Enter Detachment ID" required>
        </div>

        <div class="mb-3">
            <label for="category" class="form-label">Category:</label>
            <select class="form-select" id="category">
                <option value="smr">SMR Upload</option>
                <option value="dfas">DFAS Upload</option>
            </select>
        </div>

        <div class="mb-3">
            <label for="fileInput" class="form-label">Select File:</label>
            <input type="file" class="form-control" id="fileInput" required>
        </div>

        <button type="button" class="btn btn-primary" onclick="uploadFile()">Upload</button>
        <p id="status" class="text-center"></p>
    </form>

    <!-- Embedded Dashboard -->
    <h3 class="text-center mt-5">üìä Cadet Data Dashboard</h3>
    <iframe id="dashboardFrame" width="100%" height="600px" style="border: none;"></iframe>
</div>

<script>
    function loadDashboard() {
        const detachmentId = document.getElementById("detachmentId").value;
        if (!detachmentId) {
            alert("‚ùå Please enter a Detachment ID to view the dashboard.");
            return;
        }

        // Construct the QuickSight Embed URL with the Detachment ID filter
        const quickSightBaseUrl = "https://us-east-1.quicksight.aws.amazon.com/sn/accounts/904233093918/dashboards/67e26f37-748e-44cb-a654-6a337d32312d?directory_alias=arrowbaysolutions";
        const filteredUrl = `${quickSightBaseUrl}&p.DetachmentID=${detachmentId}`;

        // Load the filtered dashboard into the iframe
        document.getElementById("dashboardFrame").src = filteredUrl;
    }

    document.getElementById("detachmentId").addEventListener("change", loadDashboard);
</script>
